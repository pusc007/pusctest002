(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{455:function(t,e,i){},456:function(t,e,i){},457:function(t,e,i){},458:function(t,e,i){},508:function(t,e,i){"use strict";i(455)},509:function(t,e,i){"use strict";i(456)},510:function(t,e,i){"use strict";i(457)},511:function(t,e,i){"use strict";i(458)},515:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-sheet",{staticClass:"content"},[i("Header"),t._v(" "),i("v-main",{staticClass:"main"},[i("v-container",[i("v-select",{staticClass:"mt-4",attrs:{color:"cyan",items:t.cityList,label:"縣市",loading:t.cityLoading},on:{click:t.city_click,change:t.city_change},scopedSlots:t._u([{key:"no-data",fn:function(){return[i("div",{staticClass:"pa-2"},[t._v(t._s(t.cityLoading?"載入中...":"空資料"))])]},proxy:!0},{key:"selection",fn:function(e){var n=e.item;return[i("div",{staticClass:"text-truncate"},[t._v(t._s(n.text))])]}},{key:"item",fn:function(e){var n=e.item,s=e.attrs,a=e.on;return[i("v-list-item",t._g(t._b({},"v-list-item",s,!1),a),[i("v-list-item-content",[i("v-list-item-title",{attrs:{id:s["aria-labelledby"]},domProps:{textContent:t._s(n.text)}})],1)],1)]}}]),model:{value:t.cityValue,callback:function(e){t.cityValue=e},expression:"cityValue"}}),t._v(" "),t.cityValue?i("v-select",{staticClass:"mt-4",attrs:{color:"cyan",items:t.siteList,label:"檢測站點",loading:t.siteLoading},on:{click:t.site_click,change:t.site_change},scopedSlots:t._u([{key:"no-data",fn:function(){return[i("div",{staticClass:"pa-2"},[t._v(t._s(t.siteLoading?"載入中...":"空資料"))])]},proxy:!0},{key:"selection",fn:function(e){var n=e.item;return[i("div",{staticClass:"text-truncate"},[t._v(t._s(n.text))])]}},{key:"item",fn:function(e){var n=e.item,s=e.attrs,a=e.on;return[i("v-list-item",t._g(t._b({},"v-list-item",s,!1),a),[i("v-list-item-content",[i("v-list-item-title",{attrs:{id:s["aria-labelledby"]},domProps:{textContent:t._s(n.text)}})],1)],1)]}}],null,!1,3473734003),model:{value:t.siteValue,callback:function(e){t.siteValue=e},expression:"siteValue"}}):t._e(),t._v(" "),t.cityValue&&t.siteValue?i("v-toolbar",{staticClass:"d-flex justify-center",attrs:{flat:""}},[i("v-btn",{attrs:{fab:"",text:"",small:"",color:"grey darken-2"},on:{click:t.prev}},[i("v-icon",{attrs:{small:""}},[t._v("\n            mdi-chevron-left\n          ")])],1),t._v(" "),i("v-toolbar-title",[t._v(" "+t._s(t.selectYear)+" 年 "+t._s(t.selectMonth)+" 月")]),t._v(" "),i("v-btn",{attrs:{fab:"",text:"",small:"",color:"grey darken-2"},on:{click:t.next}},[i("v-icon",{attrs:{small:""}},[t._v("\n            mdi-chevron-right\n          ")])],1)],1):t._e(),t._v(" "),t.cityValue&&t.siteValue?[t.opentimesLoading?i("div",{staticClass:"d-flex justify-center text-h6"},[t._v("載入中...")]):i("Calendar",{attrs:{year:t.selectYear,month:t.selectMonth,items:t.openTimes},scopedSlots:t._u([{key:"content",fn:function(e){return[i("div",{staticClass:"dateBox px-2 py-1"},[e.item.presentMonth?i("div",{staticClass:"dateInfo"},[i("div",{staticClass:"d-flex flex-column align-center"},[e.item.bool?[i("div",{staticClass:"my-2 text-center text-md-left"},[t._v("最大車次："+t._s(e.item.maxcount))]),t._v(" "),i("div",{staticClass:"d-inline-flex flex-wrap justify-center"},[i("v-btn",{attrs:{small:"",depressed:"",color:"cyan white--text ma-1"},on:{click:function(i){return t.editItem(e.item)}}},[t._v("\n                        變更\n                      ")]),t._v(" "),i("v-btn",{attrs:{small:"",depressed:"",color:"cyan white--text ma-1"},on:{click:function(i){return t.removeItem(e.item)}}},[t._v("\n                        刪除\n                      ")])],1)]:[i("div",{staticClass:"my-2 text-center text-md-left"},[t._v("無開放")]),t._v(" "),i("v-btn",{attrs:{small:"",depressed:"",color:"cyan white--text ma-1"},on:{click:function(i){return t.addItem(e.item)}}},[t._v("\n                      登錄\n                    ")])]],2)]):t._e()])]}}],null,!1,954162485)})]:t._e()],2)],1),t._v(" "),i("DetectDateNewItem",{ref:"newItem",on:{save:t.detectDateNewItem_save}}),t._v(" "),i("DetectDateEditItem",{ref:"editItem",on:{save:t.detectDateEditItem_save}}),t._v(" "),i("Confirm",{ref:"confirm"}),t._v(" "),i("v-overlay",{attrs:{value:t.running}},[i("v-progress-circular",{attrs:{indeterminate:"",size:"64"}},[t._v("執行中...")])],1)],1)};n._withStripped=!0;var s=i(436),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-card",[i("v-card-title",{staticClass:"justify-center"},[i("span",{staticClass:"headline"},[t._v("新增")])]),t._v(" "),i("v-card-text",[i("v-container",[i("div",{staticClass:"row"},t._l(t.items,(function(e,n){return i("TableItem",{key:"item"+n,staticClass:"pa-1",attrs:{data:t.data,items:t.items,name:n,item:e}})})),1)])],1),t._v(" "),i("v-card-actions",[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItem(t.items)}}},[t._v("\n        取消\n      ")]),t._v(" "),i("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItem(t.items)}}},[t._v("\n        儲存\n      ")])],1)],1)],1)};a._withStripped=!0;var r=i(430),c=i(429),o=i(432),l=i(431),u={mixins:[c.validationMixin],components:{TableItem:o.a},validations:{data:{maxcount:{required:r.required}}},data:function(){var t=this;return{data:{},items:{maxcount:{dataType:"number",label:"最大車次",class:"col-12",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}}},show:!1}},mounted:function(){},methods:{put:function(t){this.data=JSON.parse(JSON.stringify(t))},resetData:function(){this.data={}},reset:function(){this.$v.data.$reset(),this.resetData()},cancelItem:function(t){this.show=!1},saveItem:function(t){this.$v.data.$touch(),this.$v.data.$error||(this.$emit("save",Object(l.d)(this.items,this.data)),this.show=!1)}},computed:{}},d=(i(508),i(116)),h=Object(d.a)(u,a,[],!1,null,"503d3df6",null);h.options.__file="src/vue/pages/components/DetectDateNewItem.vue";var m=h.exports,v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-card",[i("v-card-title",{staticClass:"justify-center"},[i("span",{staticClass:"headline"},[t._v("修改")])]),t._v(" "),i("v-card-text",[i("v-container",[i("div",{staticClass:"row"},t._l(t.items,(function(e,n){return i("TableItem",{key:"item"+n,staticClass:"pa-1",attrs:{data:t.data,items:t.items,name:n,item:e}})})),1)])],1),t._v(" "),i("v-card-actions",[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItem(t.items)}}},[t._v("\n        取消\n      ")]),t._v(" "),i("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItem(t.items)}}},[t._v("\n        儲存\n      ")])],1)],1)],1)};v._withStripped=!0;var p={mixins:[c.validationMixin],components:{TableItem:o.a},validations:{data:{maxcount:{required:r.required}}},data:function(){var t=this;return{originalData:{},data:{},items:{maxcount:{dataType:"number",label:"最大車次",class:"col-12",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}}},show:!1}},mounted:function(){},methods:{put:function(t){this.originalData=JSON.parse(JSON.stringify(t)),this.data=JSON.parse(JSON.stringify(t))},resetData:function(){this.data={}},reset:function(){this.$v.data.$reset(),this.resetData()},cancelItem:function(t){this.show=!1},saveItem:function(t){if(this.$v.data.$touch(),!this.$v.data.$error){var e=Object(l.c)(this.originalData,this.data);e&&(this.$emit("save",this.originalData.id,Object(l.d)(this.items,e)),this.show=!1)}}},computed:{}},f=(i(509),Object(d.a)(p,v,[],!1,null,"051cb1aa",null));f.options.__file="src/vue/pages/components/DetectDateEditItem.vue";var _=f.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"calendar"},[t._l(7,(function(e,n){return i("div",{key:"weekday"+n,staticClass:"weekday"},[t._v(t._s(t.weekdayText[n]))])})),t._v(" "),t._l(t.days,(function(e,n){return i("div",{key:"item"+n,staticClass:"date",class:{present:"present"===e.status,presentMonth:e.presentMonth}},[i("div",{staticClass:"label"},[t._v(t._s(e.date.M)+"/"+t._s(e.date.D))]),t._v(" "),i("div",{staticClass:"content"},[t._t("content",null,{item:Object.assign({},e,t.getItem(e.date.Y,e.date.M,e.date.D))})],2)])}))],2)])};y._withStripped=!0;var g=i(119),b=i.n(g);function D(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function w(t){return{Y:t.getFullYear(),M:t.getMonth()+1,D:t.getDate()}}function x(t,e){for(var i=[],n=new Date(t,e-1,1),s=n.getDay(),a=0;a<s;a++)n.setFullYear(t,e-1,1-s+a),i.push(new Date(n));for(var r=function(t,e){return new Date(t,e,0).getDate()}(t,e),c=0;c<r;c++)n.setFullYear(t,e-1,c+1),i.push(new Date(n));for(var o=0;o<42-r-s;o++)n.setFullYear(t,e,o+1),i.push(new Date(n));function l(t){return 1e4*t.Y+100*t.M+t.D}var u=l(w(new Date));return i=i.map((function(t){var i=(t=w(t)).M===e,n=l(t),s="";return n<u?s="past":n==u?s="present":n>u&&(s="future"),{date:t,status:s,presentMonth:i}}))}var k=new Date,O={components:{},props:{year:{type:[String,Number],default:k.getFullYear()},month:{type:[String,Number],default:k.getMonth()+1},items:{type:[Array],default:function(){return[]}}},data:function(){return{weekdayText:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],days:x(this.year,this.month)}},watch:{year:function(t){this.days=x(this.year,this.month)},month:function(t){this.days=x(this.year,this.month)}},mounted:function(){},methods:{getItem:function(t,e,i){var n="".concat(t,"-").concat(e.toString().padStart(2,"0"),"-").concat(i.toString().padStart(2,"0")),s=this.items.find((function(t){return t.date===n}));return s?function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?D(Object(i),!0).forEach((function(e){b()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({bool:!0},s):{bool:!1,date:n}}},computed:{}},I=(i(510),Object(d.a)(O,y,[],!1,null,"0ad61136",null));I.options.__file="src/vue/components/Calendar.vue";var $=I.exports,C=i(442),S=i(117),j={mixins:[i(118).a],components:{Header:s.a,DetectDateNewItem:m,DetectDateEditItem:_,Calendar:$,Confirm:C.a},data:function(){return{cityList:[],cityValue:"",cityLoading:!1,siteList:[],siteValue:"",siteLoading:!1,running:!1,api_citys_promise:null,api_searchSites_promise:null,api_searchOpentime_promise:null,api_searchOpentimes_promise:null,openTime:null,openTimeLoading:!1,selectYear:null,selectMonth:null,currentDay:null,opentimesLoading:!1,openTimes:[]}},mounted:function(){var t=new Date;t.setDate(1),this.currentDay=t,this.selectYear=this.currentDay.getFullYear(),this.selectMonth=this.currentDay.getMonth()+1},methods:{prev:function(){this.currentDay.setFullYear(this.currentDay.getFullYear(),this.currentDay.getMonth()-1),this.selectYear=this.currentDay.getFullYear(),this.selectMonth=this.currentDay.getMonth()+1,this.updateSiteDate()},next:function(){this.currentDay.setFullYear(this.currentDay.getFullYear(),this.currentDay.getMonth()+1),this.selectYear=this.currentDay.getFullYear(),this.selectMonth=this.currentDay.getMonth()+1,this.updateSiteDate()},updateSiteDate:function(){var t=this,e=new Date("".concat(this.selectYear,"-").concat(this.selectMonth,"-1")),i=new Date("".concat(this.selectYear+(12===this.selectMonth?1:0),"-").concat((12===this.selectMonth?0:this.selectMonth)+1,"-1"));i.setDate(0),this.api_searchOpentimes_promise&&(this.api_searchOpentimes_promise.cancel(),this.api_searchOpentimes_promise=null),this.openTimes=[],this.opentimesLoading=!0,this.api_searchOpentimes_promise=Object(S.o)(this.$store.state.token,this.cityValue,this.siteValue,e,i),this.api_searchOpentimes_promise.then((function(e){t.openTimes=e,t.opentimesLoading=!1})).catch((function(e){t.opentimesLoading=!1,t.errorAction(e)}))},city_click:function(){this.cityUpdate()},city_change:function(){this.siteValue=""},site_click:function(){this.siteUpdate()},cityUpdate:function(){var t=this;this.api_citys_promise&&(this.api_citys_promise.cancel(),this.api_citys_promise=null),this.cityList=[],this.cityLoading=!0,this.api_citys_promise=Object(S.b)(this.$store.state.token),this.api_citys_promise.then((function(e){t.cityLoading=!1,t.cityList=e})).catch((function(e){t.cityLoading=!1,t.errorAction(e)}))},siteUpdate:function(){var t=this;this.api_searchSites_promise&&(this.api_searchSites_promise.cancel(),this.api_searchSites_promise=null),this.siteList=[],this.siteLoading=!0,this.api_searchSites_promise=Object(S.p)(this.$store.state.token,this.cityValue),this.api_searchSites_promise.then((function(e){t.siteLoading=!1,t.siteList=e.map((function(t){return{id:t.id,text:t.sitename}}))})).catch((function(e){t.siteLoading=!1,t.errorAction(e)}))},site_change:function(){this.updateSiteDate()},addItem:function(t){this.$refs.newItem.reset(),this.$refs.newItem.put({city:this.cityValue,site:this.siteValue,date:t.date}),this.$refs.newItem.show=!0},editItem:function(t){this.$refs.editItem.reset(),this.$refs.editItem.put({id:t.id,city:this.cityValue,site:this.siteValue,date:t.date,maxcount:t.maxcount}),this.$refs.editItem.show=!0},removeItem:function(t){var e=this;this.$refs.confirm.run("確定刪除?",(function(){e.running=!0,Object(S.f)(e.$store.state.token,t.id).then((function(){e.running=!1,e.updateSiteDate()})).catch((function(t){e.running=!1,e.errorAction(t)}))}),(function(){}))},detectDateNewItem_save:function(t){var e=this;this.running=!0,Object(S.c)(this.$store.state.token,t).then((function(){e.running=!1,e.updateSiteDate()})).catch((function(t){e.running=!1,e.errorAction(t)}))},detectDateEditItem_save:function(t,e){var i=this;this.running=!0,Object(S.j)(this.$store.state.token,t,e).then((function(){i.running=!1,i.updateSiteDate()})).catch((function(t){i.running=!1,i.errorAction(t)}))}},computed:{}},M=(i(511),Object(d.a)(j,n,[],!1,null,"09e5f67e",null));M.options.__file="src/vue/pages/DetectDate.vue";e.default=M.exports}}]);