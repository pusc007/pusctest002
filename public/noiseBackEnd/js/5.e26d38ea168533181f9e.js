(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{441:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pa-2 d-flex align-center"},[n("v-spacer"),t._v(" "),n("div",{staticClass:"text-caption mx-1"},[t._v("每頁行數:")]),t._v(" "),n("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[n("v-btn",t._g(t._b({staticClass:"text-caption pa-0",attrs:{text:""}},"v-btn",r,!1),a),[t._v("\n        "+t._s(t.itemsPerPage)+"\n        "),n("v-icon",[t._v("mdi-chevron-down")])],1)]}}])},[t._v(" "),n("v-list",t._l(t.itemsPerPageArray,(function(e,a){return n("v-list-item",{key:a,on:{click:function(n){return t.updateItemsPerPage(e)}}},[n("v-list-item-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" "),n("div",{staticClass:"text-caption mx-1"},[t._v("\n    "+t._s(Math.min((t.page-1)*t.itemsPerPage+1,t.length))+"-"+t._s(Math.min(t.page*t.itemsPerPage,t.length))+"\n    of\n    "+t._s(t.length)+"\n  ")]),t._v(" "),n("v-btn",{attrs:{depressed:"",small:"",text:""},on:{click:t.prevPage}},[n("v-icon",[t._v("mdi-chevron-left")])],1),t._v(" "),n("v-btn",{attrs:{depressed:"",small:"",text:""},on:{click:t.nextPage}},[n("v-icon",[t._v("mdi-chevron-right")])],1)],1)};a._withStripped=!0;var r={components:{},props:{length:{type:Number,default:0},page:{type:Number,default:1},pageCount:{type:Number,default:0},itemsPerPage:{type:Number,default:15},itemsPerPageArray:{type:Array,default:function(){return[5,10,15,30,50]}}},data:function(){return{}},mounted:function(){},methods:{updateItemsPerPage:function(t){this.$emit("update:itemsPerPage",t)},prevPage:function(){this.page-1>=1&&this.$emit("update:page",this.page-1)},nextPage:function(){this.page+1<=this.pageCount&&this.$emit("update:page",this.page+1)}},computed:{}},i=n(116),s=Object(i.a)(r,a,[],!1,null,"5abfbaf6",null);s.options.__file="src/vue/pages/components/Pagination.vue";e.a=s.exports},449:function(t,e,n){},450:function(t,e,n){},453:function(t,e){},454:function(t,e,n){},496:function(t,e,n){"use strict";n(449)},497:function(t,e,n){"use strict";n(450)},503:function(t,e){},504:function(t,e){},507:function(t,e,n){"use strict";n(454)},516:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-sheet",{staticClass:"content"},[n("Header"),t._v(" "),n("v-main",{staticClass:"main"},[n("v-container",[n("div",{staticClass:"d-flex justify-center justify-md-start my-2"},[n("v-btn",{staticClass:"ma-2 cyan white--text",attrs:{depressed:""},on:{click:t.itemExport_click}},[t._v("匯出")]),t._v(" "),n("v-btn",{staticClass:"ma-2 cyan white--text",attrs:{depressed:""},on:{click:t.itemImport_click}},[t._v("匯入")]),t._v(" "),n("v-btn",{staticClass:"ma-2 cyan white--text",attrs:{depressed:""},on:{click:t.addItem}},[t._v("新增")])],1),t._v(" "),n("div",{staticClass:"d-flex flex-column flex-md-row align-md-center my-2"},[n("v-menu",{ref:"menu1",attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[n("v-text-field",t._g(t._b({staticClass:"mx-2 mt-4",attrs:{label:"起始日期","persistent-hint":"","prepend-icon":"mdi-calendar",color:"cyan",readonly:""},model:{value:t.dateStart,callback:function(e){t.dateStart=e},expression:"dateStart"}},"v-text-field",r,!1),a))]}}]),model:{value:t.menu1,callback:function(e){t.menu1=e},expression:"menu1"}},[t._v(" "),n("v-date-picker",{attrs:{"no-title":"",color:"cyan"},on:{change:t.dateStart_change},model:{value:t.dateStart,callback:function(e){t.dateStart=e},expression:"dateStart"}})],1),t._v(" "),n("v-menu",{ref:"menu2",attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[n("v-text-field",t._g(t._b({staticClass:"mx-2 mt-4",attrs:{label:"結束日期","persistent-hint":"","prepend-icon":"mdi-calendar",color:"cyan",readonly:""},model:{value:t.dateEnd,callback:function(e){t.dateEnd=e},expression:"dateEnd"}},"v-text-field",r,!1),a))]}}]),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[t._v(" "),n("v-date-picker",{attrs:{"no-title":"",color:"cyan"},on:{change:t.dateEnd_change},model:{value:t.dateEnd,callback:function(e){t.dateEnd=e},expression:"dateEnd"}})],1),t._v(" "),n("v-select",{staticClass:"mx-2 mt-4",attrs:{color:"cyan",items:t.stateList,label:"狀態"},on:{change:t.state_change},scopedSlots:t._u([{key:"selection",fn:function(e){var a=e.item;return[n("div",{staticClass:"fluid w-100 text-truncate"},[t._v(t._s(a.text))])]}},{key:"item",fn:function(e){var a=e.item,r=e.attrs,i=e.on;return[n("v-list-item",t._g(t._b({},"v-list-item",r,!1),i),[n("v-list-item-content",[n("v-list-item-title",{attrs:{id:r["aria-labelledby"]},domProps:{textContent:t._s(a.text)}})],1)],1)]}}]),model:{value:t.stateValue,callback:function(e){t.stateValue=e},expression:"stateValue"}})],1),t._v(" "),n("v-data-table",{attrs:{headers:t.headers,items:t.items,loading:t.dataLoading,"loading-text":"載入中...",page:t.page,"items-per-page":t.itemsPerPage,"hide-default-footer":"","show-select":""},on:{"update:page":function(e){t.page=e}},scopedSlots:t._u([{key:"no-data",fn:function(){return[n("div",{staticClass:"pa-2"},[t._v(t._s(t.dataLoading?"載入中...":"空資料"))])]},proxy:!0},{key:"item.actions",fn:function(e){var a=e.item;return[n("div",{staticClass:"ma-2"},[n("v-icon",{attrs:{small:""},on:{click:function(e){return t.editItem(a)}}},[t._v("mdi-pencil")]),t._v(" "),n("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteItem(a)}}},[t._v("mdi-delete")])],1)]}},{key:"footer",fn:function(e){var a=e.props;return[n("div",{staticClass:"d-flex my-2 align-center"},[t.selectItems.length?n("v-btn",{attrs:{small:"",depressed:"",color:"grey darken-1 white--text"},on:{click:t.deleteItems}},[t._v("刪除選取項目")]):t._e(),t._v(" "),n("v-spacer"),t._v(" "),!t.dataLoading&&t.items.length?n("Pagination",{attrs:{length:t.items.length,page:t.page,pageCount:a.pagination.pageCount,itemsPerPage:t.itemsPerPage},on:{"update:page":function(e){t.page=e},"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}}}):t._e()],1)]}}]),model:{value:t.selectItems,callback:function(e){t.selectItems=e},expression:"selectItems"}})],1)],1),t._v(" "),n("ReportNewItem",{ref:"newItem",on:{save:t.reportNewItem_save}}),t._v(" "),n("ReportEditItem",{ref:"editItem",on:{save:t.reportEditItem_save}}),t._v(" "),n("v-dialog",{model:{value:t.importBool,callback:function(e){t.importBool=e},expression:"importBool"}},[n("v-card",[n("v-card-title",{staticClass:"justify-center"},[n("span",{staticClass:"headline"},[t._v("匯入資料")])]),t._v(" "),n("v-card-text",[n("v-data-table",{attrs:{headers:t.mainHeaders,items:t.importItems,"item-class":t.itemClass,page:t.importPage,"items-per-page":t.importItemsPerPage,"hide-default-footer":""},on:{"update:page":function(e){t.importPage=e}},scopedSlots:t._u([{key:"no-data",fn:function(){return[n("div",{staticClass:"pa-2"},[t._v("空資料")])]},proxy:!0},{key:"footer",fn:function(e){var a=e.props;return[t.importItems.length?n("Pagination",{attrs:{length:t.importItems.length,page:t.importPage,pageCount:a.pagination.pageCount,itemsPerPage:t.importItemsPerPage},on:{"update:page":function(e){t.importPage=e},"update:itemsPerPage":function(e){t.importItemsPerPage=e},"update:items-per-page":function(e){t.importItemsPerPage=e}}}):t._e()]}}])})],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItems(t.importItems)}}},[t._v("\n          取消\n        ")]),t._v(" "),t.importItems.length&&t.saveBool?n("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItems(t.importItems)}}},[t._v("\n          儲存\n        ")]):t._e()],1)],1)],1),t._v(" "),n("Confirm",{ref:"confirm"}),t._v(" "),n("v-overlay",{attrs:{value:t.running}},[n("v-progress-circular",{attrs:{indeterminate:"",size:"64"}},[t._v("執行中...")])],1)],1)};a._withStripped=!0;var r=n(439),i=n.n(r),s=n(494),o=n.n(s),c=n(495),u=n.n(c),l=n(436),d=n(441),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("v-card",[n("v-card-title",{staticClass:"justify-center"},[n("span",{staticClass:"headline"},[t._v("新增")])]),t._v(" "),n("v-card-text",[n("v-container",[n("div",{staticClass:"row"},t._l(t.items,(function(e,a){return n("TableItem",{key:"item"+a,staticClass:"pa-1",attrs:{data:t.data,items:t.items,name:a,item:e}})})),1)])],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItem(t.items)}}},[t._v("\n        取消\n      ")]),t._v(" "),n("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItem(t.items)}}},[t._v("\n        儲存\n      ")])],1)],1)],1)};m._withStripped=!0;var p=n(119),v=n.n(p),f=n(430),h=n(429),g=n(432),y=n(117),b=n(431),_=function(t){return!t||/^\d\d\d\d\-\d\d\-\d\d$/.test(t)},x=function(t){return!!t},w=function(t){return function(e,n){return!e||!n[t]||new Date(e).getTime()<new Date(n[t]).getTime()}},k=function(t){return function(e,n){return!e||!n[t]||new Date(e).getTime()>new Date(n[t]).getTime()}},P=function(t){return function(e,n){return!e||!!n[t]}};function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){v()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={mixins:[h.validationMixin],components:{TableItem:g.a},validations:{data:{casenum:{required:f.required},username:{required:f.required},idcard:{required:f.required},carnum:{required:f.required},address:{required:f.required},city:{},site:{},redate:{dateFormat:_,dateLT:w("exdate")},exdate:{dateFormat:_,dateQT:k("redate"),otherRequired:P("redate")},result:{}}},data:function(){var t=this;return{data:{},items:{casenum:{label:"公文號",class:"col-12",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},username:{label:"姓名",class:"col-12",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},idcard:{label:"身分證/公司行號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},carnum:{label:"車牌號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},address:{label:"地址",class:"col-12",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},city:{label:"縣市",class:"col-12",type:"select",list:[],loading:!1,promise:null,click:function(e,n,a){var r=n[a];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(y.b)(t.$store.state.token),r.promise.then((function(t){r.loading=!1,r.list=t}))},change:function(e,n,a){t.data=$($({},e),{},{site:""})}},site:{label:"檢測站點",class:"col-12",type:"select",display:function(t){return t.city},list:[],loading:!1,promise:null,click:function(e,n,a){var r=n[a];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(y.p)(t.$store.state.token,e.city),r.promise.then((function(t){r.loading=!1,r.list=t.map((function(t){return{id:t.id,text:t.sitename}}))}))}},redate:{label:"預約日期",class:"col-12 col-sm-6",type:"date-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateFormat?t.$v.data[e].dateLT?void 0:"日期須比展延日期早":"請填寫正確格式YYYY-MM-DD"}},exdate:{label:"展延日期",class:"col-12 col-sm-6",type:"date-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateFormat?t.$v.data[e].dateQT?t.$v.data[e].otherRequired?void 0:"必須有預約日期":"日期須比預約日期晚":"請填寫正確格式YYYY-MM-DD"}},result:{label:"檢測結果",class:"col-12"}},show:!1}},mounted:function(){},methods:{put:function(t){this.data=JSON.parse(JSON.stringify(t))},resetData:function(){this.data={}},reset:function(){this.$v.data.$reset(),this.resetData()},cancelItem:function(t){this.show=!1},saveItem:function(t){this.$v.data.$touch(),this.$v.data.$error||(this.$emit("save",Object(b.d)(this.items,this.data)),this.show=!1)}},computed:{}},S=(n(496),n(116)),j=Object(S.a)(O,m,[],!1,null,"faf1205a",null);j.options.__file="src/vue/pages/components/ReportNewItem.vue";var q=j.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("v-card",[n("v-card-title",{staticClass:"justify-center"},[n("span",{staticClass:"headline"},[t._v("修改")])]),t._v(" "),n("v-card-text",[n("v-container",[n("div",{staticClass:"row"},t._l(t.items,(function(e,a){return n("TableItem",{key:"item"+a,staticClass:"pa-1",attrs:{data:t.data,items:t.items,name:a,item:e}})})),1)])],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItem(t.items)}}},[t._v("\n        取消\n      ")]),t._v(" "),n("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItem(t.items)}}},[t._v("\n        儲存\n      ")])],1)],1)],1)};function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){v()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}C._withStripped=!0;var N={mixins:[h.validationMixin],components:{TableItem:g.a},validations:{data:{casenum:{required:f.required},username:{required:f.required},idcard:{required:f.required},carnum:{required:f.required},address:{required:f.required},city:{},site:{},redate:{dateFormat:_,dateLT:w("exdate")},exdate:{dateFormat:_,dateQT:k("redate"),otherRequired:P("redate")},result:{}}},data:function(){var t=this;return{originalData:{},data:{},items:{casenum:{label:"公文號",class:"col-12",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},username:{label:"姓名",class:"col-12"},idcard:{label:"身分證/公司行號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},carnum:{label:"車牌號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},address:{label:"地址",class:"col-12"},city:{label:"縣市",class:"col-12",type:"select",list:[],loading:!1,promise:null,click:function(e,n,a){var r=n[a];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(y.b)(t.$store.state.token),r.promise.then((function(t){r.loading=!1,r.list=t}))},change:function(e,n,a){t.data=E(E({},e),{},{site:""})}},site:{label:"檢測站點",class:"col-12",type:"select",display:function(t){return t.city},list:[],loading:!1,promise:null,click:function(e,n,a){var r=n[a];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(y.p)(t.$store.state.token,e.city),r.promise.then((function(t){r.loading=!1,r.list=t.map((function(t){return{id:t.id,text:t.sitename}}))}))}},redate:{label:"預約日期",class:"col-12 col-sm-6",type:"date-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateFormat?t.$v.data[e].dateLT?void 0:"日期須比展延日期早":"請填寫正確格式YYYY-MM-DD"}},exdate:{label:"展延日期",class:"col-12 col-sm-6",type:"date-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateFormat?t.$v.data[e].dateQT?t.$v.data[e].otherRequired?void 0:"必須有預約日期":"日期須比預約日期晚":"請填寫正確格式YYYY-MM-DD"}},result:{label:"檢測結果",class:"col-12"}},show:!1}},mounted:function(){},methods:{put:function(t){this.originalData=JSON.parse(JSON.stringify(t)),this.data=JSON.parse(JSON.stringify(t))},reset:function(){this.$v.data.$reset(),this.data={}},cancelItem:function(t){this.show=!1},saveItem:function(t){if(this.$v.data.$touch(),!this.$v.data.$error){var e=Object(b.c)(this.originalData,this.data);e&&(this.$emit("save",this.originalData.id,Object(b.d)(this.items,e)),this.show=!1)}}},computed:{}},M=(n(497),Object(S.a)(N,C,[],!1,null,"1c18bb6d",null));M.options.__file="src/vue/pages/components/ReportEditItem.vue";var T=M.exports,B=n(442),L=n(498),A=n.n(L),Y=n(451),R=n.n(Y),F=n(505),H=n.n(F),J=n(506),Q=n.n(J),V=function(){function t(){if(H()(this,t),!(this instanceof t))return new t;this.SheetNames=[],this.Sheets={},this.wopts={bookType:"xlsx",bookSST:!1,type:"binary"}}return Q()(t,[{key:"appendSheet",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sheet".concat(this.SheetNames.length+1);this.SheetNames=[].concat(i()(this.SheetNames),[e]),this.Sheets[e]=t}},{key:"toBlob",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.wopts;function e(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),a=0;a!==t.length;++a)n[a]=255&t.charCodeAt(a);return e}var n=R.a.write(this,t),a=new Blob([e(n)],{type:"application/octet-stream"});return a}},{key:"isEmpty",value:function(){return!this.SheetNames.length&&JSON.stringify("{}"===this.Sheets)}}]),t}();function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach((function(e){v()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Z=function(t,e){for(var n=e["!ref"].split(":"),a=Object(b.a)(n[0].replace(/\d/g,"")),r=Object(b.a)(n[1].replace(/\d/g,"")),i=parseInt(n[1].replace(/^[A-Z]/g,"")),s=[],o=a;o<=r;o++)s.push(Object(b.b)(o));var c=s.map((function(n){return{w:n,header:t.find((function(t){var a;return t.text===(null===(a=e[n+"1"])||void 0===a?void 0:a.v)}))}})),u={};c.forEach((function(t){var n=t.header;if(n){u[t.w+"1"]=n.value;for(var a=2;a<=i;a++){var r=e[t.w+a],s="";if(r){if(n.type===String)s=String(r.v);else if(n.type===Number)s=Number(r.v);else if(n.type===Boolean)s=JSON.parse(String(r.v).toLowerCase());else if(n.type===Date){var o=r.v.constructor.name;s="Date"===o?Object(b.e)(r.v):"String"===o?r.v:String(r.v)}u[t.w+a]=s}else n.type===String?s="":n.type===Number?s=0:n.type===Boolean?s=!1:n.type===Date&&(s=null),u[t.w+a]=s}}}));for(var l=[],d=function(t){var e={};c.forEach((function(n){n.header&&(e[u[n.w+1]]=u[n.w+t])})),l.push(e)},m=2;m<=i;m++)d(m);return l.map((function(e){var n="";return t.some((function(t){var a=t.value,r=e[a];if(t.validation){var i={};for(var s in t.validation)i[s]=t.validation[s](r,e);if(t.errorMessages&&(n=t.errorMessages(i,e)))return!0}})),U(U({},e),{},{resMessage:n})}))},G={mixins:[n(118).a],components:{Header:l.a,Pagination:d.a,ReportNewItem:q,ReportEditItem:T,Confirm:B.a},data:function(){return{page:1,itemsPerPage:15,importPage:1,importItemsPerPage:15,dateStart:(new Date).toISOString().substr(0,10),dateEnd:(new Date).toISOString().substr(0,10),menu1:!1,menu2:!1,stateValue:"全部",stateList:[{text:"全部",key:"all"},{text:"預約",key:"reserv"},{text:"展延",key:"extend"},{text:"建立",key:"created"},{text:"更新",key:"updated"}],importBool:!1,templateHeaders:{base:[{text:"公文號",value:"casenum",type:String,validation:{required:x},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"姓名",value:"username",type:String,validation:{required:x},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"身分證/公司行號",value:"idcard",type:String,validation:{required:x},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"車牌號",value:"carnum",type:String,validation:{required:x},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"地址",value:"address",type:String,validation:{required:x},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"檢測縣市",value:"city",type:String},{text:"檢測站點",value:"site",type:String},{text:"預約日期",value:"redate",type:Date,validation:{dateFormat:_,dateLT:w("exdate")},errorMessages:function(t){return t.dateFormat?t.dateLT?void 0:"".concat(this.text,"須比展延日期早"):"".concat(this.text,"格式錯誤")}},{text:"展延日期",value:"exdate",type:Date,validation:{dateFormat:_,dateQT:k("redate"),otherRequired:P("redate")},errorMessages:function(t){return t.dateFormat?t.dateQT?t.otherRequired?void 0:"".concat(this.text,"必須有預約日期"):"".concat(this.text,"須比預約日期晚"):"".concat(this.text,"格式錯誤")}},{text:"檢測結果",value:"result",type:String}],table:[{text:"動作",value:"actions",sortable:!1}],import:[{text:"回饋訊息",value:"resMessage"}]},items:[],importItems:[],dataLoading:!1,running:!1,saveBool:!1,selectItems:[]}},mounted:function(){this.updateInquire()},methods:{itemClass:function(t){return t.resMessage?"error":""},updateInquire:function(){var t=this;if(!this.dataLoading){this.dataLoading=!0;var e=this.stateList.find((function(e){return e.text===t.stateValue}));Object(y.r)(this.$store.state.token,this.dateStart,this.dateEnd,e.key).then((function(e){t.dataLoading=!1,t.items=e})).catch((function(e){t.dataLoading=!1,t.errorAction(e)}))}},addItem:function(){this.$refs.newItem.reset(),this.$refs.newItem.show=!0},editItem:function(t){this.$refs.editItem.reset(),this.$refs.editItem.put(t),this.$refs.editItem.show=!0},deleteItems:function(){var t=this,e=this.selectItems.map((function(t){return t.id}));this.$refs.confirm.run("確定刪除?",(function(){t.running=!0,Object(y.i)(t.$store.state.token,e).then((function(){t.running=!1,t.selectItems=[],t.updateInquire()})).catch((function(e){t.running=!1,t.errorAction(e)}))}),(function(){}))},deleteItem:function(t){var e=this;this.$refs.confirm.run("確定刪除?",(function(){e.running=!0,Object(y.h)(e.$store.state.token,t.id).then((function(){e.running=!1,e.updateInquire()})).catch((function(t){e.running=!1,e.errorAction(t)}))}),(function(){}))},reportNewItem_save:function(t){var e=this;this.running=!0,Object(y.e)(this.$store.state.token,t).then((function(){e.running=!1,e.updateInquire()})).catch((function(t){e.running=!1,e.$refs.newItem.show=!0,e.errorAction(t)}))},reportEditItem_save:function(t,e){var n=this;this.running=!0,Object(y.l)(this.$store.state.token,t,e).then((function(){n.running=!1,n.updateInquire()})).catch((function(t){n.running=!1,n.$refs.editItem.show=!0,n.errorAction(t)}))},dateStart_change:function(){this.updateInquire()},dateEnd_change:function(){this.updateInquire()},state_change:function(){this.updateInquire()},itemImport_click:function(){var t=this;return u()(o.a.mark((function e(){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(t,e){var n=document.createElement("input");n.type="file",n.accept=".xls,.xlsx",n.addEventListener("change",(function(){var e=new FileReader;e.onload=function(){var n=R.a.read(e.result,{type:"array",cellDates:!0}),a=n.Sheets[n.SheetNames[0]];t(a)},e.readAsArrayBuffer(n.files[0])})),n.click()}));case 2:n=e.sent,a=t.templateHeaders.base;try{r=Z(a,n),t.saveBool=r.every((function(t){return!t.resMessage})),t.importItems=r,t.importBool=!0}catch(t){alert(t.message)}case 5:case"end":return e.stop()}}),e)})))()},itemExport_click:function(){var t,e,n,a,r,s,o,c;r=this.templateHeaders.base,s=this.items,o=r.map((function(t){return t.text})),c=s.map((function(t){return r.map((function(e){return t[e.value]}))})),t=[o].concat(i()(c)),e="資料.xlsx",n=R.a.utils.aoa_to_sheet(t),(a=new V).appendSheet(n,"mySheet"),A.a.saveAs(a.toBlob(),e)},cancelItems:function(){this.importBool=!1,this.importItems=[]},saveItems:function(){var t=this;this.importBool=!1,this.running=!0,Object(y.m)(this.$store.state.token,this.importItems).then((function(){t.running=!1,t.importItems=[],t.updateInquire()})).catch((function(e){t.running=!1,t.importBool=!0,t.errorAction(e)}))},inquire_click:function(){this.updateInquire()}},computed:{headers:function(){return[].concat(i()(this.templateHeaders.base),i()(this.templateHeaders.table))},mainHeaders:function(){return this.saveBool?i()(this.templateHeaders.base):[].concat(i()(this.templateHeaders.import),i()(this.templateHeaders.base))}}},K=(n(507),Object(S.a)(G,a,[],!1,null,"0935f3c1",null));K.options.__file="src/vue/pages/Report.vue";e.default=K.exports}}]);