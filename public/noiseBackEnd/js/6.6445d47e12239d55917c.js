(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{431:function(t,e,a){},432:function(t,e,a){},436:function(t,e,a){"use strict";a(431)},437:function(t,e,a){"use strict";a(432)},439:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-app-bar",{staticClass:"bar",attrs:{app:"","elevate-on-scroll":""}},[a("v-container",{staticClass:"pa-0 fill-height"},[a("div",{staticClass:"mr-10 d-flex flex-md-column align-center"},[a("img",{staticClass:"logo",attrs:{src:t.logo}})]),t._v(" "),a("Menu",{staticClass:"d-none d-md-flex"}),t._v(" "),a("v-spacer"),t._v(" "),a("Logout",{staticClass:"d-none d-md-flex"}),t._v(" "),a("v-app-bar-nav-icon",{staticClass:"d-flex d-md-none",on:{click:function(e){t.$refs.sidebar.isOpen=!t.$refs.sidebar.isOpen}}})],1)],1),t._v(" "),a("Sidebar",{ref:"sidebar",scopedSlots:t._u([{key:"content",fn:function(){return[a("div",{staticClass:"d-flex pa-4"},[a("Logout"),t._v(" "),a("v-spacer"),t._v(" "),a("v-icon",{on:{click:function(e){t.$refs.sidebar.isOpen=!1}}},[t._v("\n          mdi-close\n        ")])],1),t._v(" "),a("Menu",{staticClass:"d-flex flex-column"})]},proxy:!0}])})],1)};n._withStripped=!0;var r=function(){var t=this.$createElement;return(this._self._c||t)("v-btn",{staticClass:"cyan white--text",attrs:{depressed:""},on:{click:this.logout_click}},[this._v("登出")])};r._withStripped=!0;var i={mixins:[a(119).a],components:{},data:function(){return{}},mounted:function(){},methods:{logout_click:function(){this.logout()}},computed:{}},s=a(118),o=Object(s.a)(i,r,[],!1,null,"6ea3a2e6",null);o.options.__file="src/vue/pages/components/Logout.vue";var c=o.exports,l=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("v-btn",{staticClass:"pageItem",attrs:{depressed:"",text:"",to:{name:"CaseInquiry"},"active-class":"active"}},[this._v("案件查詢")]),this._v(" "),e("v-btn",{staticClass:"pageItem",attrs:{depressed:"",text:"",to:{name:"Report"},"active-class":"active"}},[this._v("報表")]),this._v(" "),e("v-btn",{staticClass:"pageItem",attrs:{depressed:"",text:"",to:{name:"DetectSite"},"active-class":"active"}},[this._v("檢測站點")]),this._v(" "),e("v-btn",{staticClass:"pageItem",attrs:{depressed:"",text:"",to:{name:"DetectDate"},"active-class":"active"}},[this._v("檢測日期")])],1)};l._withStripped=!0;var u={components:{},data:function(){return{}},mounted:function(){},methods:{},computed:{}},d=(a(436),Object(s.a)(u,l,[],!1,null,"3111d13b",null));d.options.__file="src/vue/pages/components/Menu.vue";var m=d.exports,p=function(){var t=this,e=t.$createElement;return(t._self._c||e)("v-navigation-drawer",{attrs:{right:"",app:"",temporary:""},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[t._t("content")],2)};p._withStripped=!0;var v={components:{},props:{},watch:{},data:function(){return{isOpen:!1,resizeID:void 0}},mounted:function(){window.addEventListener("resize",this.resize)},beforeDestroy:function(){window.removeEventListener("resize",this.resize)},methods:{resize:function(){var t=this;clearTimeout(this.resizeID),this.resizeID=setTimeout((function(){t.isOpen&&t.$vuetify.breakpoint.mdAndUp&&(t.isOpen=!1)}),300)}},computed:{}},f=Object(s.a)(v,p,[],!1,null,"2e4a0ea0",null);f.options.__file="src/vue/pages/components/Sidebar.vue";var h=f.exports,g=a(440),b={components:{Logout:c,Menu:m,Sidebar:h},data:function(){return{logo:g.a}},mounted:function(){},methods:{},computed:{}},_=(a(437),Object(s.a)(b,n,[],!1,null,"023c3669",null));_.options.__file="src/vue/pages/components/Header.vue";e.a=_.exports},443:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pa-2 d-flex align-center"},[a("v-spacer"),t._v(" "),a("div",{staticClass:"text-caption mx-1"},[t._v("每頁行數:")]),t._v(" "),a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"text-caption pa-0",attrs:{text:""}},"v-btn",r,!1),n),[t._v("\n        "+t._s(t.itemsPerPage)+"\n        "),a("v-icon",[t._v("mdi-chevron-down")])],1)]}}])},[t._v(" "),a("v-list",t._l(t.itemsPerPageArray,(function(e,n){return a("v-list-item",{key:n,on:{click:function(a){return t.updateItemsPerPage(e)}}},[a("v-list-item-title",[t._v(t._s(e))])],1)})),1)],1),t._v(" "),a("div",{staticClass:"text-caption mx-1"},[t._v("\n    "+t._s(Math.min((t.page-1)*t.itemsPerPage+1,t.length))+"-"+t._s(Math.min(t.page*t.itemsPerPage,t.length))+"\n    of\n    "+t._s(t.length)+"\n  ")]),t._v(" "),a("v-btn",{attrs:{depressed:"",small:"",text:""},on:{click:t.prevPage}},[a("v-icon",[t._v("mdi-chevron-left")])],1),t._v(" "),a("v-btn",{attrs:{depressed:"",small:"",text:""},on:{click:t.nextPage}},[a("v-icon",[t._v("mdi-chevron-right")])],1)],1)};n._withStripped=!0;var r={components:{},props:{length:{type:Number,default:0},page:{type:Number,default:1},pageCount:{type:Number,default:0},itemsPerPage:{type:Number,default:15},itemsPerPageArray:{type:Array,default:function(){return[5,10,15,30,50]}}},data:function(){return{}},mounted:function(){},methods:{updateItemsPerPage:function(t){this.$emit("update:itemsPerPage",t)},prevPage:function(){this.page-1>=1&&this.$emit("update:page",this.page-1)},nextPage:function(){this.page+1<=this.pageCount&&this.$emit("update:page",this.page+1)}},computed:{}},i=a(118),s=Object(i.a)(r,n,[],!1,null,"5abfbaf6",null);s.options.__file="src/vue/pages/components/Pagination.vue";e.a=s.exports},444:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"300px"},model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[a("v-card",{staticClass:"pa-4",attrs:{light:""}},[a("v-card-text",{staticClass:"text-center"},[t._v(" "+t._s(t.message))]),t._v(" "),a("v-card-actions",{staticClass:"justify-center"},[a("v-btn",{attrs:{depressed:""},on:{click:t.cancelBtn_click}},[t._v("\n        取消\n      ")]),t._v(" "),a("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:t.certainBtn_click}},[t._v("\n        確定\n      ")])],1)],1)],1)};n._withStripped=!0;var r={components:{},data:function(){return{alert:!1,message:"",certainFun:null,cancelFun:null}},mounted:function(){},methods:{run:function(t,e,a){this.alert=!0,this.message=t,this.certainFun=e,this.cancelFun=a},cancelBtn_click:function(){this.alert=!1,this.cancelFun()},certainBtn_click:function(){this.alert=!1,this.certainFun()}},computed:{}},i=a(118),s=Object(i.a)(r,n,[],!1,null,"6fce52e9",null);s.options.__file="src/vue/components/Confirm.vue";e.a=s.exports},456:function(t,e,a){},457:function(t,e,a){},460:function(t,e){},461:function(t,e,a){},501:function(t,e,a){"use strict";a(456)},502:function(t,e,a){"use strict";a(457)},508:function(t,e){},509:function(t,e){},512:function(t,e,a){"use strict";a(461)},521:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-sheet",{staticClass:"content"},[a("Header"),t._v(" "),a("v-main",{staticClass:"main"},[a("v-container",[a("div",{staticClass:"d-flex justify-center justify-md-start my-2"},[a("v-btn",{staticClass:"ma-2 cyan white--text",attrs:{depressed:""},on:{click:t.itemExport_click}},[t._v("匯出")]),t._v(" "),a("v-btn",{staticClass:"ma-2 cyan white--text",attrs:{depressed:""},on:{click:t.itemImport_click}},[t._v("匯入")]),t._v(" "),a("v-btn",{staticClass:"ma-2 cyan white--text",attrs:{depressed:""},on:{click:t.addItem}},[t._v("新增")])],1),t._v(" "),a("div",{staticClass:"d-flex flex-column flex-md-row align-md-center my-2"},[a("v-menu",{attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[a("v-text-field",t._g(t._b({staticClass:"mx-2",attrs:{label:"起始日期","persistent-hint":"","prepend-icon":"mdi-calendar",color:"cyan",readonly:""},model:{value:t.dateStart,callback:function(e){t.dateStart=e},expression:"dateStart"}},"v-text-field",r,!1),n))]}}])},[t._v(" "),a("v-date-picker",{attrs:{"no-title":"",color:"cyan"},on:{change:t.dateStart_change},model:{value:t.dateStart,callback:function(e){t.dateStart=e},expression:"dateStart"}})],1),t._v(" "),a("v-menu",{attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,r=e.attrs;return[a("v-text-field",t._g(t._b({staticClass:"mx-2",attrs:{label:"結束日期","persistent-hint":"","prepend-icon":"mdi-calendar",color:"cyan",readonly:""},model:{value:t.dateEnd,callback:function(e){t.dateEnd=e},expression:"dateEnd"}},"v-text-field",r,!1),n))]}}])},[t._v(" "),a("v-date-picker",{attrs:{"no-title":"",color:"cyan"},on:{change:t.dateEnd_change},model:{value:t.dateEnd,callback:function(e){t.dateEnd=e},expression:"dateEnd"}})],1),t._v(" "),a("v-select",{staticClass:"mx-2",attrs:{color:"cyan",items:t.stateList,label:"狀態"},on:{change:t.state_change},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.item;return[a("div",{staticClass:"fluid w-100 text-truncate"},[t._v(t._s(n.text))])]}},{key:"item",fn:function(e){var n=e.item,r=e.attrs,i=e.on;return[a("v-list-item",t._g(t._b({},"v-list-item",r,!1),i),[a("v-list-item-content",[a("v-list-item-title",{attrs:{id:r["aria-labelledby"]},domProps:{textContent:t._s(n.text)}})],1)],1)]}}]),model:{value:t.stateValue,callback:function(e){t.stateValue=e},expression:"stateValue"}})],1),t._v(" "),a("v-data-table",{attrs:{headers:t.headers,items:t.items,loading:t.dataLoading,"loading-text":"載入中...",page:t.page,"items-per-page":t.itemsPerPage,"hide-default-footer":"","show-select":""},on:{"update:page":function(e){t.page=e}},scopedSlots:t._u([{key:"no-data",fn:function(){return[a("div",{staticClass:"pa-2"},[t._v(t._s(t.dataLoading?"載入中...":"空資料"))])]},proxy:!0},{key:"item.actions",fn:function(e){var n=e.item;return[a("div",{staticClass:"ma-2"},[a("v-icon",{attrs:{small:""},on:{click:function(e){return t.editItem(n)}}},[t._v("mdi-pencil")]),t._v(" "),a("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteItem(n)}}},[t._v("mdi-delete")])],1)]}},{key:"footer",fn:function(e){var n=e.props;return[a("div",{staticClass:"d-flex my-2 align-center"},[t.selectItems.length?a("v-btn",{attrs:{small:"",depressed:"",color:"grey darken-1 white--text"},on:{click:t.deleteItems}},[t._v("刪除選取項目")]):t._e(),t._v(" "),a("v-spacer"),t._v(" "),!t.dataLoading&&t.items.length?a("Pagination",{attrs:{length:t.items.length,page:t.page,pageCount:n.pagination.pageCount,itemsPerPage:t.itemsPerPage},on:{"update:page":function(e){t.page=e},"update:itemsPerPage":function(e){t.itemsPerPage=e},"update:items-per-page":function(e){t.itemsPerPage=e}}}):t._e()],1)]}}]),model:{value:t.selectItems,callback:function(e){t.selectItems=e},expression:"selectItems"}})],1)],1),t._v(" "),a("ReportNewItem",{ref:"newItem",on:{save:t.reportNewItem_save}}),t._v(" "),a("ReportEditItem",{ref:"editItem",on:{save:t.reportEditItem_save}}),t._v(" "),a("v-dialog",{model:{value:t.importBool,callback:function(e){t.importBool=e},expression:"importBool"}},[a("v-card",[a("v-card-title",{staticClass:"justify-center"},[a("span",{staticClass:"headline"},[t._v("匯入資料")])]),t._v(" "),a("v-card-text",[a("v-data-table",{attrs:{headers:t.mainHeaders,items:t.importItems,"item-class":t.importItemClass,page:t.importPage,"items-per-page":t.importItemsPerPage,"hide-default-footer":""},on:{"update:page":function(e){t.importPage=e}},scopedSlots:t._u([{key:"no-data",fn:function(){return[a("div",{staticClass:"pa-2"},[t._v("空資料")])]},proxy:!0},{key:"footer",fn:function(e){var n=e.props;return[t.importItems.length?a("Pagination",{attrs:{length:t.importItems.length,page:t.importPage,pageCount:n.pagination.pageCount,itemsPerPage:t.importItemsPerPage},on:{"update:page":function(e){t.importPage=e},"update:itemsPerPage":function(e){t.importItemsPerPage=e},"update:items-per-page":function(e){t.importItemsPerPage=e}}}):t._e()]}}])})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItems(t.importItems)}}},[t._v("\n          取消\n        ")]),t._v(" "),t.importItems.length&&t.saveBool?a("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItems(t.importItems)}}},[t._v("\n          儲存\n        ")]):t._e()],1)],1)],1),t._v(" "),a("Confirm",{ref:"confirm"}),t._v(" "),a("v-overlay",{attrs:{value:t.running}},[a("v-progress-circular",{attrs:{indeterminate:"",size:"64"}},[t._v("執行中...")])],1)],1)};n._withStripped=!0;var r=a(441),i=a.n(r),s=a(499),o=a.n(s),c=a(500),l=a.n(c),u=a(70),d=a.n(u),m=a(439),p=a(443),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"900px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",{staticClass:"justify-center py-2"},[a("span",{staticClass:"headline text-h6"},[t._v("新增")])]),t._v(" "),a("v-card-text",[a("v-container",[a("div",{staticClass:"row"},t._l(t.items,(function(e,n){return a("TableItem",{key:"item"+n,staticClass:"pa-1",attrs:{data:t.data,items:t.items,name:n,item:e}})})),1)])],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItem(t.items)}}},[t._v("\n        取消\n      ")]),t._v(" "),a("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItem(t.items)}}},[t._v("\n        儲存\n      ")])],1)],1)],1)};v._withStripped=!0;var f=a(430),h=a(438),g=a(120),b=a(30),_=a(434);function y(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function x(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?y(Object(a),!0).forEach((function(e){d()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var w={mixins:[f.validationMixin],components:{TableItem:h.a},validations:{data:{casenum:{required:_.d},username:{required:_.d},idcard:{required:_.d},carnum:{required:_.d},address:{required:_.d},city:{},site:{},reDateRange:{required:_.d,dateRangeFormat:_.a},reDateTimeRange:{dateTimeRangeFormat:_.b},exDateRange:{required:_.d,dateRangeFormat:_.a},exDateTimeRange:{dateTimeRangeFormat:_.b},result:{},contactName:{},contactPhone:{},contactEmail:{emailFormat:_.c}}},data:function(){var t=this;return{data:{},items:{casenum:{label:"公文號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},carnum:{label:"車牌號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},username:{label:"姓名",class:"col-12 col-sm-6 col-md-3",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},idcard:{label:"身分證/公司行號",class:"col-12 col-sm-6 col-md-3",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},address:{label:"地址",class:"col-12 col-md-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},city:{label:"移轉縣市",class:"col-12",type:"select",list:[],loading:!1,promise:null,click:function(e,a,n){var r=a[n];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(g.a)(t.$store.state.token),r.promise.then((function(t){r.loading=!1,r.list=t}))},change:function(e,a,n){t.data=x(x({},e),{},{site:""})}},site:{label:"檢測站點",class:"col-12",type:"select",list:[],loading:!1,promise:null,click:function(e,a,n){var r=a[n];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(g.r)(t.$store.state.token),r.promise.then((function(t){r.loading=!1,r.list=t.map((function(t){return{id:t.id,text:t.sitename}}))}))}},reDateRange:{label:"可預約日期範圍",class:"col-12 col-md-4",type:"dateRange-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?t.$v.data[e].dateRangeFormat?void 0:"格式錯誤 YYYY-MM-DD~YYYY-MM-DD":"請填寫這個欄位。"}},reDateTimeRange:{label:"預約日期_預約時段",class:"col-12 col-md-8",type:"dateTimeRange-select",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateTimeRangeFormat?void 0:"格式錯誤 YYYY-MM-DD_hh:mm~hh:mm"}},exDateRange:{label:"可展延日期範圍",class:"col-12 col-md-4",type:"dateRange-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?t.$v.data[e].dateRangeFormat?void 0:"格式錯誤 YYYY-MM-DD~YYYY-MM-DD":"請填寫這個欄位。"}},exDateTimeRange:{label:"展延日期_展延時段",class:"col-12 col-md-8",type:"dateTimeRange-select",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateTimeRangeFormat?void 0:"格式錯誤 YYYY-MM-DD_hh:mm~hh:mm"}},result:{label:"檢測結果",class:"col-12"},contactName:{label:"聯絡姓名",class:"col-12 col-sm-6 col-md-3"},contactPhone:{label:"聯絡電話",class:"col-12 col-sm-6 col-md-3"},contactEmail:{label:"聯絡電子信箱",class:"col-12 col-md-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].emailFormat?void 0:"格式錯誤 XXX@XXX.XXX"}}},show:!1}},mounted:function(){},methods:{put:function(t){this.data=JSON.parse(JSON.stringify(t))},resetData:function(){this.data={}},reset:function(){this.$v.data.$reset(),this.resetData()},cancelItem:function(t){this.show=!1},saveItem:function(t){this.$v.data.$touch(),this.$v.data.$error||(this.$emit("save",Object(b.d)(this.items,this.data)),this.show=!1)}},computed:{}},O=(a(501),a(118)),$=Object(O.a)(w,v,[],!1,null,"faf1205a",null);$.options.__file="src/vue/pages/components/ReportNewItem.vue";var P=$.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"900px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",{staticClass:"justify-center py-2"},[a("span",{staticClass:"headline text-h6"},[t._v("修改")])]),t._v(" "),a("v-card-text",[a("v-container",[a("div",{staticClass:"row"},t._l(t.items,(function(e,n){return a("TableItem",{key:"item"+n,staticClass:"pa-1",attrs:{data:t.data,items:t.items,name:n,item:e}})})),1)])],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.cancelItem(t.items)}}},[t._v("\n        取消\n      ")]),t._v(" "),a("v-btn",{attrs:{depressed:"",color:"cyan white--text"},on:{click:function(e){return t.saveItem(t.items)}}},[t._v("\n        儲存\n      ")])],1)],1)],1)};function I(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?I(Object(a),!0).forEach((function(e){d()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}k._withStripped=!0;var S={mixins:[f.validationMixin],components:{TableItem:h.a},validations:{data:{casenum:{required:_.d},username:{required:_.d},idcard:{required:_.d},carnum:{required:_.d},address:{required:_.d},city:{},site:{},reDateRange:{required:_.d,dateRangeFormat:_.a},reDateTimeRange:{dateTimeRangeFormat:_.b},exDateRange:{required:_.d,dateRangeFormat:_.a},exDateTimeRange:{dateTimeRangeFormat:_.b},result:{},contactName:{},contactPhone:{},contactEmail:{emailFormat:_.c}}},data:function(){var t=this;return{originalData:{},data:{},items:{casenum:{label:"公文號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},carnum:{label:"車牌號",class:"col-12 col-sm-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},username:{label:"姓名",class:"col-12 col-sm-6 col-md-3"},idcard:{label:"身分證/公司行號",class:"col-12 col-sm-6 col-md-3",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?void 0:"請填寫這個欄位。"}},address:{label:"地址",class:"col-12 col-md-6"},city:{label:"移轉縣市",class:"col-12",type:"select",list:[],loading:!1,promise:null,click:function(e,a,n){var r=a[n];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(g.a)(t.$store.state.token),r.promise.then((function(t){r.loading=!1,r.list=t}))},change:function(e,a,n){t.data=D(D({},e),{},{site:""})}},site:{label:"檢測站點",class:"col-12",type:"select",list:[],loading:!1,promise:null,click:function(e,a,n){var r=a[n];r.promise&&(r.promise.cancel(),r.promise=null),r.list=[],r.loading=!0,r.promise=Object(g.r)(t.$store.state.token),r.promise.then((function(t){r.loading=!1,r.list=t.map((function(t){return{id:t.id,text:t.sitename}}))}))}},reDateRange:{label:"可預約日期範圍",class:"col-12 col-md-4",type:"dateRange-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?t.$v.data[e].dateRangeFormat?void 0:"格式錯誤 YYYY-MM-DD~YYYY-MM-DD":"請填寫這個欄位。"}},reDateTimeRange:{label:"預約日期_預約時段",class:"col-12 col-md-8",type:"dateTimeRange-select",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateTimeRangeFormat?void 0:"格式錯誤 YYYY-MM-DD_hh:mm~hh:mm"}},exDateRange:{label:"可展延日期範圍",class:"col-12 col-md-4",type:"dateRange-picker",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].required?t.$v.data[e].dateRangeFormat?void 0:"格式錯誤 YYYY-MM-DD~YYYY-MM-DD":"請填寫這個欄位。"}},exDateTimeRange:{label:"展延日期_展延時段",class:"col-12 col-md-8",type:"dateTimeRange-select",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].dateTimeRangeFormat?void 0:"格式錯誤 YYYY-MM-DD_hh:mm~hh:mm"}},result:{label:"檢測結果",class:"col-12"},contactName:{label:"聯絡姓名",class:"col-12 col-sm-6 col-md-3"},contactPhone:{label:"聯絡電話",class:"col-12 col-sm-6 col-md-3"},contactEmail:{label:"聯絡電子信箱",class:"col-12 col-md-6",errors:function(e){if(t.$v.data[e].$dirty)return t.$v.data[e].emailFormat?void 0:"格式錯誤 XXX@XXX.XXX"}}},show:!1}},mounted:function(){},methods:{put:function(t){this.originalData=JSON.parse(JSON.stringify(t)),this.data=JSON.parse(JSON.stringify(t))},reset:function(){this.$v.data.$reset(),this.data={}},cancelItem:function(t){this.show=!1},saveItem:function(t){if(this.$v.data.$touch(),!this.$v.data.$error){var e=Object(b.c)(this.originalData,this.data);e?(this.$emit("save",this.originalData.id,Object(b.d)(this.items,e),Object(b.d)(this.items,this.data)),this.show=!1):this.show=!1}}},computed:{}},j=(a(502),Object(O.a)(S,k,[],!1,null,"1c18bb6d",null));j.options.__file="src/vue/pages/components/ReportEditItem.vue";var Y=j.exports,R=a(444),C=a(503),M=a.n(C),q=a(458),E=a.n(q),F=a(510),T=a.n(F),N=a(511),X=a.n(N),B=function(){function t(){if(T()(this,t),!(this instanceof t))return new t;this.SheetNames=[],this.Sheets={},this.wopts={bookType:"xlsx",bookSST:!1,type:"binary"}}return X()(t,[{key:"appendSheet",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sheet".concat(this.SheetNames.length+1);this.SheetNames=[].concat(i()(this.SheetNames),[e]),this.Sheets[e]=t}},{key:"toBlob",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.wopts;function e(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!==t.length;++n)a[n]=255&t.charCodeAt(n);return e}var a=E.a.write(this,t),n=new Blob([e(a)],{type:"application/octet-stream"});return n}},{key:"isEmpty",value:function(){return!this.SheetNames.length&&JSON.stringify("{}"===this.Sheets)}}]),t}();function L(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function A(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?L(Object(a),!0).forEach((function(e){d()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var H=function(t,e){for(var a=e["!ref"].split(":"),n=Object(b.a)(a[0].replace(/\d/g,"")),r=Object(b.a)(a[1].replace(/\d/g,"")),i=parseInt(a[1].replace(/^[A-Z]/g,"")),s=[],o=n;o<=r;o++)s.push(Object(b.b)(o));var c=s.map((function(a){return{w:a,header:t.find((function(t){var n;return t.text===(null===(n=e[a+"1"])||void 0===n?void 0:n.v)}))}})),l={};c.forEach((function(t){var a=t.header;if(a){l[t.w+"1"]=a.value;for(var n=2;n<=i;n++){var r=e[t.w+n],s="";if(r){if(a.type===String)s=String(r.v);else if(a.type===Number)s=Number(r.v);else if(a.type===Boolean)s=JSON.parse(String(r.v).toLowerCase());else if(a.type===Date){var o=r.v.constructor.name;s="Date"===o?Object(b.h)(r.v):"String"===o?r.v:String(r.v)}l[t.w+n]=s}else a.type===String?s="":a.type===Number?s=0:a.type===Boolean?s=!1:a.type===Date&&(s=null),l[t.w+n]=s}}}));for(var u=[],d=function(t){var e={};c.forEach((function(a){a.header&&(e[l[a.w+1]]=l[a.w+t])})),u.push(e)},m=2;m<=i;m++)d(m);return u.map((function(e){var a="";return t.some((function(t){var n=t.value,r=e[n];if(t.validation){var i={};for(var s in t.validation)i[s]=t.validation[s](r,e);if(t.errorMessages&&(a=t.errorMessages(i,e)))return!0}})),A(A({},e),{},{resMessage:a})}))};function J(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function z(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?J(Object(a),!0).forEach((function(e){d()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var V={mixins:[a(119).a],components:{Header:m.a,Pagination:p.a,ReportNewItem:P,ReportEditItem:Y,Confirm:R.a},data:function(){return{page:1,itemsPerPage:15,importPage:1,importItemsPerPage:15,dateStart:(new Date).toISOString().substr(0,10),dateEnd:(new Date).toISOString().substr(0,10),stateValue:"全部",stateList:[{text:"全部",key:"all"},{text:"預約",key:"reserv"},{text:"展延",key:"extend"}],importBool:!1,templateHeaders:{base:[{text:"公文號",value:"casenum",type:String,validation:{required:_.d},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"車牌號",value:"carnum",type:String,validation:{required:_.d},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"姓名",value:"username",type:String,validation:{required:_.d},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"身分證/公司行號",value:"idcard",type:String,validation:{required:_.d},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"地址",value:"address",type:String,validation:{required:_.d},errorMessages:function(t){if(!t.required)return"".concat(this.text,"不能空白")}},{text:"移轉縣市",value:"city",type:String},{text:"檢測站點",value:"site",type:String},{text:"可預約日期範圍",value:"reDateRange",class:"min-w-190",type:String,validation:{required:_.d,dateRangeFormat:_.a},errorMessages:function(t){return t.required?t.dateRangeFormat?void 0:"".concat(this.text,"格式錯誤 YYYY-MM-DD~YYYY-MM-DD"):"".concat(this.text,"不能空白")}},{text:"預約日期_預約時段",value:"reDateTimeRange",class:"min-w-190",type:String,validation:{dateTimeRangeFormat:_.b},errorMessages:function(t){if(!t.dateTimeRangeFormat)return"".concat(this.text,"格式錯誤 YYYY-MM-DD_hh:mm~hh:mm")}},{text:"可展延日期範圍",value:"exDateRange",class:"min-w-190",type:String,validation:{required:_.d,dateRangeFormat:_.a},errorMessages:function(t){return t.required?t.dateRangeFormat?void 0:"".concat(this.text,"格式錯誤 YYYY-MM-DD~YYYY-MM-DD"):"".concat(this.text,"不能空白")}},{text:"展延日期_展延時段",value:"exDateTimeRange",class:"min-w-190",type:String,validation:{dateTimeRangeFormat:_.b},errorMessages:function(t){if(!t.dateTimeRangeFormat)return"".concat(this.text,"格式錯誤 YYYY-MM-DD_hh:mm~hh:mm")}},{text:"檢測結果",value:"result",type:String},{text:"聯絡姓名",value:"contactName",type:String},{text:"聯絡電話",value:"contactPhone",type:String},{text:"聯絡電子信箱",value:"contactEmail",type:String,validation:{emailFormat:_.c},errorMessages:function(t){if(!t.emailFormat)return"".concat(this.text,'"格式錯誤 XXX@XXX.XXX')}}],table:[{text:"動作",value:"actions",sortable:!1}],import:[{text:"回饋訊息",value:"resMessage"}]},items:[],importItems:[],dataLoading:!1,running:!1,saveBool:!1,selectItems:[]}},mounted:function(){this.updateInquire()},methods:{importItemClass:function(t){return t.resMessage?"error":""},updateInquire:function(){var t=this;if(!this.dataLoading){this.dataLoading=!0;var e=this.stateList.find((function(e){return e.text===t.stateValue}));Object(g.q)(this.$store.state.token,new Date(this.dateStart),new Date(this.dateEnd),e.key).then((function(e){t.dataLoading=!1,t.items=e})).catch((function(e){t.dataLoading=!1,t.errorAction(e)}))}},addItem:function(){this.$refs.newItem.reset(),this.$refs.newItem.show=!0},editItem:function(t){this.$refs.editItem.reset(),this.$refs.editItem.put(t),this.$refs.editItem.show=!0},deleteItems:function(){var t=this,e=this.selectItems.map((function(t){return t.id}));this.$refs.confirm.run("確定刪除?",(function(){t.running=!0,Object(g.i)(t.$store.state.token,e).then((function(){t.running=!1,t.selectItems=[],t.updateInquire()})).catch((function(e){t.running=!1,t.errorAction(e)}))}),(function(){}))},deleteItem:function(t){var e=this;this.$refs.confirm.run("確定刪除?",(function(){e.running=!0,Object(g.h)(e.$store.state.token,t.id).then((function(){e.running=!1,e.updateInquire()})).catch((function(t){e.running=!1,e.errorAction(t)}))}),(function(){}))},reportNewItem_save:function(t){var e=this;this.running=!0,Object(g.d)(this.$store.state.token,t).then((function(){e.running=!1,e.updateInquire()})).catch((function(t){e.running=!1,e.$refs.newItem.show=!0,e.errorAction(t)}))},reportEditItem_save:function(t,e,a){var n=this;this.running=!0,!!e.redate^!!e.retimeRange&&(e=z(z({},e),{},{redate:a.redate,retimeRange:a.retimeRange})),!!e.exdate^!!e.extimeRange&&(e=z(z({},e),{},{exdate:a.exdate,extimeRange:a.extimeRange})),Object(g.l)(this.$store.state.token,t,e).then((function(){n.running=!1,n.updateInquire()})).catch((function(t){n.running=!1,n.$refs.editItem.show=!0,n.errorAction(t)}))},dateStart_change:function(){this.updateInquire()},dateEnd_change:function(){this.updateInquire()},state_change:function(){this.updateInquire()},itemImport_click:function(){var t=this;return l()(o.a.mark((function e(){var a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(t,e){var a=document.createElement("input");a.type="file",a.accept=".xls,.xlsx",a.addEventListener("change",(function(){var e=new FileReader;e.onload=function(){var a=E.a.read(e.result,{type:"array",cellDates:!0}),n=a.Sheets[a.SheetNames[0]];t(n)},e.readAsArrayBuffer(a.files[0])})),a.click()}));case 2:a=e.sent,n=t.templateHeaders.base;try{r=H(n,a),t.saveBool=r.every((function(t){return!t.resMessage})),t.importItems=r,t.importBool=!0}catch(t){alert(t.message)}case 5:case"end":return e.stop()}}),e)})))()},itemExport_click:function(){var t,e,a,n,r,s,o,c;r=this.templateHeaders.base,s=this.items,o=r.map((function(t){return t.text})),c=s.map((function(t){return r.map((function(e){return t[e.value]}))})),t=[o].concat(i()(c)),e="資料.xlsx",a=E.a.utils.aoa_to_sheet(t),(n=new B).appendSheet(a,"mySheet"),M.a.saveAs(n.toBlob(),e)},cancelItems:function(){this.importBool=!1,this.importItems=[]},saveItems:function(){var t=this;this.importBool=!1,this.running=!0,Object(g.m)(this.$store.state.token,this.importItems).then((function(){t.running=!1,t.importItems=[],t.updateInquire()})).catch((function(e){t.running=!1,t.importBool=!0,t.errorAction(e)}))},inquire_click:function(){this.updateInquire()}},computed:{headers:function(){return[].concat(i()(this.templateHeaders.base.filter((function(t){var e;return null===(e=t.display)||void 0===e||e}))),i()(this.templateHeaders.table.filter((function(t){var e;return null===(e=t.display)||void 0===e||e}))))},mainHeaders:function(){return this.saveBool?i()(this.templateHeaders.base.filter((function(t){var e;return null===(e=t.display)||void 0===e||e}))):[].concat(i()(this.templateHeaders.import.filter((function(t){var e;return null===(e=t.display)||void 0===e||e}))),i()(this.templateHeaders.base.filter((function(t){var e;return null===(e=t.display)||void 0===e||e}))))}}},U=(a(512),Object(O.a)(V,n,[],!1,null,"0935f3c1",null));U.options.__file="src/vue/pages/Report.vue";e.default=U.exports}}]);